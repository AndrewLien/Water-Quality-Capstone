---
title: "Exploratory-Data-Analysis"
author: "Andrew Lien"
date: "May 25, 2018"
output: html_document
---

SECTIONS:
- CORRELATIONS TABLE
- E. COLI VS DETERMINAND
- TIME RELATIONSHIPS

Most important plots are plots 2c through 2i. These will likely be the ones that will be used to derive a predictive model.


## 1. CORRELATIONS TABLE

```{r echo = F, messages = F}
# Importing files and packages
library(ggplot2)
water.raw.ecoli <- read.csv("water.raw.ecoli.csv", stringsAsFactors = F)
water.raw.ecoli$time <- as.POSIXct(water.raw.ecoli$time, format = "%Y-%m-%d", tz = "GMT")
```
A correlation table gives a quick picture of whether there are correlations between any of the determinands and e. coli concentration. The table below shows that a linear model may not be the most effective predictive model. For that reason, each determinand is plotted against e. coli in section 2.
```{r}
cor.ecoli <- NULL
for(i in 5:length(water.raw.ecoli)){
  assign(x = paste("x", i, sep = "-"), value = cor(x = water.raw.ecoli[i], y = water.raw.ecoli$E.coli.C.MF.no.100ml, use = "complete.obs"))
  cor.ecoli <- rbind(cor.ecoli, get(paste("x", i, sep = "-")))
}
row.names(cor.ecoli) <- colnames(water.raw.ecoli[,5:length(water.raw.ecoli)])
cor.ecoli
```

## 2. E. COLI VS DETERMINAND

Each determinand is plotted on the x-axis against the e. coli concentration on the y-axis. Points are grouped into either above (red) or below (blue) the water quality limit of 900 no/100mL.

```{r echo = F}
water.raw.ecoli$E.coli.C.MF.conform <- water.raw.ecoli$E.coli.C.MF.no.100ml < 900
```

### 2a. E. coli vs. Ammonia.N
No apparent relationship.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Ammonia.N..mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2b. E. coli vs. COD (chemical oxygen demand)
No apparent relationship.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `COD.as.O2.mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2c. E. coli vs. Nitrate.N
Slight exponential relationship, with more occurances of high e. coli concentrations at low concentration of Nitrate.N. 
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Nitrate.N.mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2d. E. coli vs. Nitrite.N
Slight exponential relationship.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Nitrite.N.mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2e. E. coli vs. Dissolved Oxygen
Higher number of occurances of high e.coli at low oxygen dissolved amounts.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Oxygen.Diss.mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2f. E. coli vs. pH
```{r echo = F}
ifelse(mean(water.raw.ecoli$pH.phunits, na.rm = T) > median(water.raw.ecoli$pH.phunits, na.rm = T), "Positively-skewed normal distribution", "Negative-skewed normal distribution")
```
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `pH.phunits`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2g. E. coli vs. Salinity
Strong exponential relationship.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `SALinsitu.ppt`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2h. E. coli vs. Solids dissolved at 105 C
Exponential relationship.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Sld.Sus.105C.mg.l`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

### 2i. E. coli vs. Water Temperature
```{r echo = F}
ifelse(mean(water.raw.ecoli$Temp.Water.cel, na.rm = T) > median(water.raw.ecoli$Temp.Water.cel, na.rm = T), "Positively-skewed normal distribution", "Negative-skewed normal distribution")
```
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = `Temp.Water.cel`, y = `E.coli.C.MF.no.100ml`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```


## 3. TIME RELATIONSHIPS

### 3a. Time vs. e. coli
Increased number of occurences of high concentrations of e. coli in summers.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = time, y = `E.coli.C.MF.no.100ml`)) + geom_point(alpha = 0.2)
```

### 3b. Time vs. Water temperature
Water is warmer in summer. Self-evident.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = time, y = `Temp.Water.cel`)) + geom_point(alpha = 0.2)
```

### 3c. Time vs Dissolved Oxygen
Fluctuates with season as expected, higher in winter and lower in summer. Liquids can carry more dissolved gasses at lower temperature.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = time, y = `Oxygen.Diss.mg.l`)) + geom_point(alpha = 0.2)
```

### 3d. Time vs. salinity
Measured far more often in summers.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = time, y = `SALinsitu.ppt`)) + geom_point(alpha = 0.2)
```

### 3e. Time vs Solids Suspended at 105 C
No obvious relationship, other than the fact that most points that are above a certain value in solids suspended also happen to have e. coli concentrations above water quality standards.
```{r warning = F}
ggplot(water.raw.ecoli, aes(x = time, y = `Sld.Sus.105C.mg.l`, color = E.coli.C.MF.conform)) + geom_point(alpha = 0.2)
```

